#:import PPCHoverPathButton kivy.uix.buttonversions.PPCHoverPathButton
#:import Gradient src.modules.gradient.Gradient
#:import time_header src.uix.modules.headers.time_header
#:import profile_header src.uix.modules.headers.profile_header

<SmallTownButton@PPCHoverPathButton>:
    collision_source: 'buttons/smallbutton.collision.png'


<TownMain>:
    name: 'town_main'
    background_source: 'town_background.jpg'
    RelativeLayout:
        id: overlay_background
        size_hint: 1, 0.05
        pos_hint: {'top': 1}
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                size: self.size
            Color:
                rgba: 0, 0, 0, 1
            Rectangle:
                size: self.width * 0.8025, self.height * 0.05
                pos: self.width * 0.09875, 0
        Label:
            id: profile_header
            size_hint: None, 0.75
            width: self.texture_size[0] * 1.125
            pos_hint: {'x': 0.125, 'center_y': 0.5}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: profile_header()
        Label:
            id: time_header
            size_hint: None, 0.75
            width: self.texture_size[0] * 1.125
            pos_hint: {'right': 0.875, 'center_y': 0.5}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: time_header()
    RelativeLayout:
        id: left_side_layout
        size_hint: 0.1, 0.95
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                size: self.size
            Color:
                rgba: 0, 0, 0, 1
            Rectangle:
                size: root.height * 0.0025, self.height
                pos: self.width - root.height * 0.0025, 0

        SmallTownButton:
            id: tavern
            size_hint: 0.9, 0.192 # 0.1, 0.203
            pos_hint: {'x': 0.05, 'top': 0.9808}
            path: 'buttons/tavern_button'
            on_release: root.on_tavern()
            Image:
                id: tavern_lock
                source: 'buttons/small_button_lock.png'
                size: tavern.size
                pos: tavern.pos
        Label:
            id: tavern_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.7888}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Tavern'
        SmallTownButton:
            id: shop
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.7356}
            path: 'buttons/shop_button'
            on_release: root.on_shop()
        Label:
            id: shop_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.5436}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Shop'
        SmallTownButton:
            id: quests
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.4904}
            path: 'buttons/quest_button'
            on_release: root.on_quests()
        Label:
            id: quests_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.2984}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Quests'
        SmallTownButton:
            id: crafting
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.2452}
            path: 'buttons/crafting_button'
            on_release: root.on_crafting()
            Image:
                id: crafting_lock
                source: 'buttons/small_button_lock.png'
                size: crafting.size
                pos: crafting.pos
        Label:
            id: crafting_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.0532}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Crafting'

    RelativeLayout:
        id: right_side_layout
        size_hint: 0.1, 0.95
        pos_hint: {'right': 1}
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                size: self.size
            Color:
                rgba: 0, 0, 0, 1
            Rectangle:
                size: root.height * 0.0025, self.height
                pos: 0, 0

        SmallTownButton:
            id: inventory
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.9808}
            path: 'buttons/inventory_button'
            on_release: root.on_inventory()
        Label:
            id: inventory_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.7888}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Inventory'
        SmallTownButton:
            id: profile
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.7356}
            path: 'buttons/smallbutton'
            on_release: root.on_profile()
            Image:
                size_hint: 0.75, 0.75
                pos: self.parent.x + self.parent.width * 0.2, self.parent.y + self.parent.height * 0.25
                source: root.profile_source
        Label:
            id: profile_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.5436}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Profile'
        SmallTownButton:
            id: almanac
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.4904}
            path: 'buttons/almanac_button'
            on_release: root.on_almanac()
        Label:
            id: almanac_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.2984}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Almanac'
        SmallTownButton:
            id: housing
            size_hint: 0.9, 0.192
            pos_hint: {'x': 0.05, 'top': 0.2452}
            path: 'buttons/housing_button'
            on_release: root.on_housing()
        Label:
            id: housing_label
            size_hint: 1, 0.034
            pos_hint: {'top': 0.0532}
            font_size: '20pt'
            font_name: 'Precious'
            color: 0, 0, 0, 1
            text: 'Housing'
    RelativeLayout:
        id: center_layout
        size_hint: 0.35, 0.23
        pos_hint: {'center_x': 0.5}
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                size: self.size
            Color:
                rgba: 0, 0, 0, 1
            Rectangle:
                size: root.height * 0.0025, self.height
                pos: 0, 0
            Rectangle:
                size: self.width, root.height * 0.0025
                pos: 0, self.height - root.height * 0.0025
            Rectangle:
                size: root.height * 0.0025, self.height
                pos: self.width - root.height * 0.0025, 0
    SmallTownButton:
        id: exit_game
        size_hint: 0.1, 0.203
        pos_hint: {'right': 0.425, 'center_y': 0.131}
        path: 'buttons/exit_button'
        on_release: root.on_exit_game()
    Label:
        id: exit_label
        size_hint: 0.1, 0.032
        pos_hint: {'right': 0.425}
        font_size: '20pt'
        font_name: 'Precious'
        color: 0, 0, 0, 1
        text: 'Exit'
    PPCHoverPathButton:
        id: dungeon
        size_hint: 0.15, 0.198
        pos_hint: {'center_x': 0.5, 'center_y': 0.131}
        path: 'buttons/dungeon_button'
        collision_source: 'buttons/largebutton.collision.png'
        on_release: root.on_dungeon()
    Label:
        id: dungeon_label
        size_hint: 0.15, 0.032
        pos_hint: {'center_x': 0.5}
        font_size: '20pt'
        font_name: 'Precious'
        color: 0, 0, 0, 1
        text: 'Dungeon'
    SmallTownButton:
        id: save_game
        size_hint: 0.1, 0.203
        pos_hint: {'x': 0.575, 'center_y': 0.131}
        path: 'buttons/save_button'
        on_release: root.on_save_game()
    Label:
        id: save_label
        size_hint: 0.1, 0.032
        pos_hint: {'x': 0.575}
        font_size: '20pt'
        font_name: 'Precious'
        color: 0, 0, 0, 1
        text: 'Save'

    RelativeLayout:
        id: housing_warning
        opacity: 0
        size_hint: 0.65, 0.05
        pos_hint: {'center_x': 0.5, 'top': 0.925}
        canvas:
            Color:
                rgba: 1, 0, 0, 1
            Rectangle:
                size: self.size
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                size: self.width * 0.995, self.height - self.width * 0.005
                pos: self.width * 0.0025, self.width * 0.0025
        Label:
            id: warning_label
            size_hint: 1, 1,
            font_size: '24pt'
            font_name: 'Precious'
            color: 1, 0, 0, 1
            text: 'Your housing bill is due in 2 days!'